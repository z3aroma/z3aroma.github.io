<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Elenco citofoni Z3A</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@ionic/core/css/ionic.bundle.css" />
  <script defer src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.js"></script>
  <script defer src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
  <script defer src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
  <script defer src="https://unpkg.com/react-papaparse@3.7.0/umd/react-papaparse.min.js"></script>
  <link rel="stylesheet" href="index.css">
</head>
<body>
  <div id="root"></div>
  <script>
    const { IonApp, IonHeader, IonTitle, IonToolbar, IonContent, IonSearchbar, IonList, IonItem, IonLabel, IonPage } = window.ionic;
    const { readRemoteFile } = window.reactPapaParse;
    const { useState, useEffect } = React;

    const App = () => {
      const [searchText, setSearchText] = useState('');
      const [citofoni, setCitofoni] = useState([]);

      // Read data from CSV file using Papaparse
      useEffect(() => {
        readRemoteFile('data/citofoni_z3a.csv', {
          header: true,
          complete: (result) => {
            setCitofoni(result.data);
          },
        });
      }, []);

      // Function to handle sorting
      const sortBy = (key) => {
        setCitofoni((prevCitofoni) => [...prevCitofoni].sort((a, b) => (a[key] > b[key] ? 1 : -1)));
      };

      // Filter citofoni based on search
      const filteredCitofoni = citofoni.filter((citofono) =>
        citofono.cognome.toLowerCase().includes(searchText.toLowerCase()) ||
        citofono.codice.toLowerCase().includes(searchText.toLowerCase())
      );

      return (
        React.createElement(IonApp, null,
          React.createElement(IonPage, null,
            React.createElement(IonHeader, null,
              React.createElement(IonToolbar, null,
                React.createElement(IonTitle, null, "Elenco citofoni Z3A")
              )
            ),
            React.createElement(IonContent, null,
              React.createElement(IonSearchbar, {
                value: searchText,
                onIonChange: (e) => setSearchText(e.detail.value),
                debounce: 200,
                placeholder: "Cerca per cognome o codice citofono"
              }),
              React.createElement('div', { className: "sort-buttons" },
                React.createElement('button', { onClick: () => sortBy('cognome') }, "Ordina per Cognome"),
                React.createElement('button', { onClick: () => sortBy('codice') }, "Ordina per Codice Citofono")
              ),
              React.createElement(IonList, null,
                filteredCitofoni.map((citofono, index) => (
                  React.createElement(IonItem, { key: index },
                    React.createElement(IonLabel, null,
                      React.createElement('h2', null, citofono.cognome),
                      React.createElement('p', null, `Codice Citofono: ${citofono.codice}`)
                    )
                  )
                ))
              )
            )
          )
        )
      );
    };

    ReactDOM.render(React.createElement(App), document.getElementById('root'));
  </script>
</body>
</html>
